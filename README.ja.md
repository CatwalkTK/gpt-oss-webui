# GPT-OSS WebUI with Vector Search RAG

Next.js 15とReact 19で構築された、**ベクトル検索RAG（Retrieval-Augmented Generation）**機能を搭載した最新のChatGPTクローンです。ローカル文書インデックスとインテリジェント検索が可能です。

## 🚀 特徴

### コアチャット機能
- **リアルタイムAIチャット**: ストリーミング応答による対話型会話
- **複数チャット管理**: 複数の会話を同時に管理
- **カスタムGPT**: 個人専用AIアシスタントの作成・管理
- **会話スターター**: クイックチャット開始用の事前定義プロンプト
- **マルチモーダル対応**: 画像、PDF、Officeドキュメントの処理

### 🔍 高度なベクトル検索 & RAG
- **ローカル文書インデックス**: ベクトル埋め込みを使用した地文書のローカルインデックス
- **インテリジェント検索**: AIによる文書の意味的検索
- **文脈認識応答**: 関連文書の内容で強化されたAI回答
- **リアルタイム文書処理**: 自動テキスト抽出とチャンク化
- **ブラウザベース保存**: IndexedDBによる完全ローカルデータ保存

### 📁 サポートファイル形式
- **テキストファイル**: `.txt`, `.md`, `.js`, `.ts`, `.jsx`, `.tsx`, `.py`, `.java`, `.cpp`, `.c`
- **ウェブファイル**: `.html`, `.css`, `.json`, `.xml`, `.yml`, `.yaml`, `.sql`
- **スクリプト**: `.sh`, `.bat`, `.php`, `.rb`, `.go`, `.rs`, `.swift`
- **ドキュメント**: `.pdf`, `.docx`, `.doc`, `.xlsx`, `.xls`, `.pptx`, `.ppt`

### 🌏 言語サポート
- **日本語言語**: 日本語テキスト処理とOCRの完全サポート
- **多言語対応**: インテリジェントな文脈切り替えによる多言語サポート
- **IME統合**: 日本語入力中の誤送信防止

## 🏗️ 技術アーキテクチャ

### フロントエンドスタック
- **Next.js 15**: React 19ベースのモダンWebフレームワーク
- **TypeScript**: タイプセーフな開発環境
- **Tailwind CSS**: カスタムスタイリングシステム
- **KaTeX**: 美しい数学記法レンダリング
- **Heroicons**: 包括的なアイコンライブラリ

### AI & 検索スタック
- **Ollama統合**: ローカルAIモデル実行
- **ベクトル埋め込み**: 文書埋め込み用`nomic-embed-text`
- **コサイン類似度**: 意味検索アルゴリズム
- **IndexedDB**: ブラウザネイティブベクトル保存
- **ストリーミングAPI**: リアルタイム応答生成

### RAG実装
```
文書 → テキスト抽出 → チャンク化 → 埋め込み → ベクトル保存
                                                    ↓
ユーザークエリ → 埋め込み → 類似度検索 → 文脈注入 → AI応答
```

## 📦 インストール

### 前提条件
- **Node.js 18+**
- **Ollama**（ローカルAI実行用）

### セットアップ
1. **リポジトリのクローン**
   ```bash
   git clone https://github.com/CatwalkTK/gpt-oss-webui.git
   cd gpt-oss-webui
   ```

2. **依存関係のインストール**
   ```bash
   npm install
   ```

3. **AIモデルのインストール**
   ```bash
   # チャットモデル（いずれかを選択）
   ollama pull deepseek-r1:7b
   
   # 埋め込みモデル（ベクトル検索に必要）
   ollama pull nomic-embed-text
   ```

4. **開発サーバーの起動**
   ```bash
   npm run dev
   ```

5. **アプリケーションへのアクセス**
   - メインチャット: http://localhost:3000
   - ベクトル検索: http://localhost:3000/search
   - カスタムGPT: http://localhost:3000/mygpts

## 🎯 使用ガイド

### 基本チャット
1. メインページに移動
2. "Start a new chat"をクリック
3. メッセージを入力してEnterを押す
4. ストリーミングAI応答を楽しむ

### 文書検索 & RAG
1. **検索ページへ移動**: http://localhost:3000/search

2. **文書のインデックス**:
   - **オプションA**: "Index Folder"をクリック（Chrome/Edgeのみ）
   - **オプションB**: 個別ファイル用"Add Files"をクリック
   - **オプションC**: ファイルを直接ドラッグ&ドロップ

3. **文書検索**:
   - 検索バーを使用して関連コンテンツを検索
   - 類似度スコアと文書プレビューを表示

4. **文脈付きチャット**:
   - 検索ページから新しいチャットを開始
   - 質問すると、AIが関連文書を自動的に文脈として使用
   - 応答にソース文書への参照が含まれる

### カスタムGPT
1. "My GPTs"に移動
2. "Create a GPT"をクリック
3. 名前、説明、指示、会話スターターを設定
4. 特殊タスク用のカスタムGPTを使用

## 🔧 設定

### 環境変数
```env
NEXT_PUBLIC_API_URL=http://localhost:11434  # Ollama APIエンドポイント
```

### モデル設定
`src/lib/constants.ts`を更新:
```typescript
export const API_CONFIG = {
  DEFAULT_MODEL: 'deepseek-r1:7b',  # お好みのチャットモデル
  EMBEDDING_MODEL: 'nomic-embed-text'  # ベクトル検索用埋め込みモデル
}
```

## 🗂️ プロジェクト構造

```
gpt-oss-webui/
├── src/
│   ├── app/                    # Next.js App Routerページ
│   │   ├── page.tsx           # メインチャットインターフェース
│   │   ├── search/            # ベクトル検索 & RAGページ
│   │   └── mygpts/           # カスタムGPT管理
│   ├── components/            # Reactコンポーネント
│   │   ├── VectorSearch.tsx  # 文書インデックス & 検索UI
│   │   ├── MessageBubble.tsx # チャットメッセージ表示
│   │   └── ChatInput.tsx     # ファイル対応メッセージ入力
│   ├── hooks/                 # Reactフック
│   │   ├── useVectorSearch.ts # ベクトル検索機能
│   │   ├── useChatWithRAG.ts # RAG拡張チャット
│   │   └── useChat.ts        # 標準チャット機能
│   ├── lib/                   # コアサービス
│   │   ├── vectorStore.ts    # IndexedDBベクトル保存
│   │   ├── embeddingService.ts # AI埋め込み生成
│   │   ├── documentIndexer.ts # 文書処理
│   │   └── ragApi.ts         # RAG API統合
│   └── types/                 # TypeScript型定義
├── public/                    # 静的アセット
└── package.json              # 依存関係とスクリプト
```

## 🌟 主要コンポーネント

### ベクトル検索システム
- **VectorStore**: IndexedDBベースのローカルベクトルデータベース
- **EmbeddingService**: AIによるテキスト埋め込み生成
- **DocumentIndexer**: ファイル処理とチャンク化システム
- **RAG API**: 文脈認識応答生成

### チャットシステム
- **メッセージストリーミング**: リアルタイム応答表示
- **ファイル添付**: マルチモーダル会話サポート
- **文脈管理**: インテリジェントな会話履歴
- **カスタムGPT**: パーソナライズされたAIアシスタント作成

## 🔍 ブラウザ互換性

### ディレクトリピッカー（完全フォルダーインデックス）
- ✅ **Google Chrome 86+**
- ✅ **Microsoft Edge 86+**
- ❌ Firefox, Safari（代わりに"Add Files"を使用）

### ファイルアップロード & コア機能
- ✅ **すべてのモダンブラウザ**
- ✅ **ドラッグ&ドロップサポート**
- ✅ **IndexedDB保存**

## 🚀 パフォーマンス

### インデックスパフォーマンス
- **テキストファイル**: ~100-500ファイル/分
- **バイナリファイル**: より低速、サイズに依存
- **チャンクサイズ**: 500文字（設定可能）
- **埋め込み生成**: ~100ms/チャンク

### 検索パフォーマンス
- **ベクトル類似度**: リアルタイム（<100ms）
- **結果ランキング**: コサイン類似度ベース
- **文脈取得**: トップK関連チャンク

## 📄 ライセンス

このプロジェクトは最大保護のための**トリプルライセンス**システムを使用:

### 🔓 **オープンソースライセンス: AGPL-3.0**
- ✅ **個人・教育・研究**: 自由に使用、変更、配布
- ✅ **ネットワークサービス**: すべてのユーザーにソースコード提供必須
- ✅ **変更**: AGPL-3.0でリリース必須
- ❌ **商用クローズドソース**: このライセンスでは許可されません

### 💼 **商用ライセンス: 利用可能**
- ✅ **プロプライエタリ統合**: ソースコード開示不要
- ✅ **商用サービス**: SaaS、エンタープライズデプロイメント許可
- ✅ **クローズドソース配布**: 完全な商用権利
- ✅ **プレミアムサポート**: 技術サポートと保証含む

### 📚 **ドキュメントライセンス: CC BY-NC-SA 4.0**
- ✅ **共有・改変**: 非営利目的
- ✅ **帰属表示必須**: オリジナル作者をクレジット
- ❌ **商用利用**: 別途許可が必要

---

### 🤝 **ライセンス選択**

| 使用ケース | 必要ライセンス | 連絡先 |
|-----------|---------------|--------|
| **個人・教育** | AGPL-3.0（無料） | 自由に使用 |
| **オープンソースプロジェクト** | AGPL-3.0（無料） | 改善を共有必須 |
| **商用製品** | 商用ライセンス | [商用ライセンス取得](mailto:tsuda@ryowa-inc.co.jp) |
| **エンタープライズ/SaaS** | 商用ライセンス | [エンタープライズ問い合わせ](mailto:tsuda@ryowa-inc.co.jp) |

### 💡 **なぜこのライセンス構造？**

この**トリプルライセンス**アプローチにより以下が保証されます:
- 🌟 **革新保護**: 高度なRAG技術が確実に保護される
- 💰 **収益機会**: 商用利用者が受ける価値に対して支払う
- 🤝 **コミュニティ成長**: オープンソースコミュニティも恩恵を受けて貢献可能
- ⚖️ **法的明確性**: 明確な条件でライセンス混乱を防止

**ライセンスに関するご質問？** 連絡先: [tsuda@ryowa-inc.co.jp](mailto:tsuda@ryowa-inc.co.jp)

詳細な条件については[LICENSE](./LICENSE)ファイルを参照してください。

## 🤝 貢献

貢献を歓迎します！以下のガイドラインに従ってください:
1. リポジトリをフォーク
2. 機能ブランチを作成
3. 変更を加える
4. 該当する場合はテストを追加
5. プルリクエストを提出

## 🙏 謝辞

- **Ollama** ローカルAIモデル実行
- **Next.js** チーム 優秀なフレームワーク
- **Nomic AI** 埋め込みモデル
- **OpenAI** API互換性標準